\section{Data view}

I data viewet beskrives layout af data der gemmes og hvordan det lagres. Desuden beskrives hvordan data sendes rundt i systemet og hvordan database tilgås. 

MANGLER LIDT INDLEDENDE TEKST

\subsection{Database design}

\subsubsection*{Mission}
Databasen har til formål at vise systemets brugere hvilke droner der er til rådighed. Blandt andet skal det være muligt for bruger at se hvilke droner der er ude og flyve og hvilke der ikke er aktive. Derudover tracker databasen hvilke events der foregår med hver drone og danner historik over hvert event. Eksempler på events kan være information om flyveruten og om der tages billeder på flyveturen.

\subsubsection*{Design}
På figur \ref{fig:database_design} ses det overordnede designet af databasen. Som beskrevet i foranalysen er det valgt at gøre brug af en SQLight database. Alt kommunikation til og fra databasen vil fungere igennem et database API. Database API'et er et REST API som er udviklet ved brug af Django og Django REST frameworket. Ved kombination af disse Django og Django REST fås en databasen som er "indkapslet" og kun kan tilgås gennem API'et. Kommunikationen til og fra API'et foregår ved sende eller modtage JSON filer til API'ets endpoints. Hjælpe tabellerne som ses på figur \ref{fig:database_design} bliver automatisk oprettet af django frameworket, hvilket betyder de senere ikke er til at finde i koden for databasen. Hjælpe tabellerne er dog tegnet med på diagrammet, da de eksistere i systemet kan være med til at forstærke forståelsen af databasen. 


\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{Billeder/database/database_design.png}
	\vspace{-.5cm}
	\caption{Database design}
	\label{fig:database_design}
\end{figure}


\newpage
\subsubsection*{Tilgængelige endpoints}
De tilgængelige endpoint i API'et er følgende:

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							& \textbf{\textit{api/waypoints/}}\\\hline
Allows:									& POST, OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til waypoints tabellen, med muglighed for at tilføje nye waypoints\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{Waypoint endpoint}
\label{waypoint_endpoint}
\end{table}

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							& \textbf{\textit{api/users/}} \\\hline
Allows:									& OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til user tabellen\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{User endpoint}
\label{user_endpoint}
\end{table}

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							&\textbf{\textit{api/pictures/}} \\\hline
Allows:									& POST, OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til pictures tabellen, med mulighed for at tilføje nye billeder\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{Picture endpoint}
\label{picture_endpoint}
\end{table}

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							&\textbf{\textit{api/events/}}\\\hline
Allows:									& POST, PUT, OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til event tabellen, med mulighed for at oprette nye events og opdatere dem\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{Event endpoint}
\label{event_endpoint}
\end{table}

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							&\textbf{\textit{api/drones/}}\\\hline
Allows:									& POST, OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til drone tabellen, med mulighed for at tilføje nye droner\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{Drones endpoint}
\label{drones_endpoint}
\end{table}

\begin{table}[H]
\begin{tabular}{| p{3cm}| p{11.5cm}|}
\hline
Endpoint:	 							&\textbf{\textit{api/drones/\#/}}\\\hline
Allows:									& PUT, OPTIONS, GET\\\hline
Content-Type:						& application/json\\\hline 
Indehold:								& Giver adgang til en record i drone tabellen, med mulighed for at opdatere droner\\\hline 
Kommentar:							& Det er muligt at tilføje "?format=json" til URL'en for at få dataen i ren json format\\\hline
\end{tabular}
\caption{Single drone endpoint}
\label{single_drone_endpoint}
\end{table}

\newpage
\subsection{Detaljeret database beskrivelse}

\input{Kapitler/database/user_table_detail}
\newpage
\input{Kapitler/database/event_table_detail}
\newpage
\input{Kapitler/database/picture_table_detail}
\newpage
\input{Kapitler/database/waypoint_table_detail}
\newpage
\input{Kapitler/database/drone_table_detail}

